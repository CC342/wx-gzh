# WeChat Reward Auto-Reply Bot (微信公众号打赏自动回复机器人)

这是一个运行在 Linux/Armbian 环境下的 Python 自动化工具。它能全自动监控微信公众号后台的打赏记录，根据打赏文章的标题，自动匹配预设的回复内容，并通过私信发送给打赏用户。

## ✨ 功能特点

* **全自动监控**：7x24小时后台运行，毫秒级捕捉新打赏。
* **智能防封**：模拟真实用户作息（高峰期每3分钟扫描，深夜每1小时扫描）。
* **抗干扰读取**：完美解决公众号后台“新消息红点”导致的页面结构变化问题。
* **真实模拟**：支持 Emoji 表情发送，模拟真实键盘敲击，避开自动化检测。
* **自动归档**：自动生成 `rewards.json` 记录数据，防止重复发送。

## 📂 文件说明

核心文件仅需以下 3 个，其余文件会在运行后自动生成：

* `main.py`: 机器人核心主程序（守护进程）。
* `menu.sh`: 交互式管理脚本（启动、停止、查看日志）。
* `format.cookies.py`: 用于扫码登录并生成 Cookie 文件的工具。
* `return.json`: **[需手动创建]** 配置文件，定义文章标题和回复内容的对应关系。

## 🚀 使用方法

### 1. 环境准备 (Armbian/Linux)

本项目依赖 Python 3 和 Chromium 浏览器。请在终端执行以下命令进行安装：

**第一步：安装系统级依赖 (浏览器和驱动)**
```bash
sudo apt update
sudo apt install python3-pip chromium chromium-driver -y
```

**第二步：安装 Python 依赖**
```bash
pip3 install -r requirements.txt
```

### 2. 配置回复规则

在项目根目录下创建一个 `return.json` 文件，填写文章标题（需完全匹配）和对应的回复内容：

```json
{
    "标题": "回复",
    "标题": "回复"
}

```

### 3. 获取登录凭证

填写cookies，运行登录脚本，：

```bash
python3 format.cookies.py

```

*成功后，目录下会自动生成 `wechat_cookies.pkl` 文件。*

### 4. 启动机器人

使用管理脚本启动服务：

```bash
chmod +x gzh.sh
./gzh.sh

```

在菜单中输入 **`1`** 启动机器人。脚本将会在后台静默运行，根据时间段自动调整扫描频率。

---

## 🛠️ 管理菜单说明

运行 `./menu.sh` 后可进行以下操作：

* `1. 启动机器人`：后台运行 `main.py` 并实时记录日志。
* `2. 停止机器人`：安全结束后台进程。
* `3. 重启机器人`：修改代码或配置后使用。
* `4. 查看实时日志`：查看当前运行状态（按 `Ctrl+C` 退出查看，机器人继续运行）。

## ⚠️ 注意事项

* **无需手动干预**：`rewards.json`（打赏记录）、`bot.log`（运行日志）、`manual_check.txt`（异常记录）等文件会在程序运行时自动生成，无需手动创建。
* **Cookie 有效期**：微信 Cookie 可能会定期失效。如果日志提示“登录失败”，请重新执行第 3 步生成新的 Cookie。
